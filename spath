#!/bin/bash
function s_shelp()
{
    echo "This command search for files in the PATH"
}

. "${S_UTIL_INSTALL_DIR}/s_init.sh"

NONE_EXEC=0
REG=0

for ((i = 0;i <= $#;)) ;do
    case ${!i} in
	-r|--reg)
	    shift $i
	    REG=1
	    ;;
	-n|--noexec)
	    shift $i
	    NONE_EXEC=1
	    ;;
	-p|--path)
	    shift $i
	    PATH=${!i}
	    shift $i
	    ;;
	*)
	    let 'i++'
	    ;;
    esac
done

command="find -L ${PATH//:/ } -maxdepth 1 -type f"
[ ${NONE_EXEC} = 0 ] && command="${command} -and -perm /111"

if [ $# = "0" ] ;then
    $command
fi

ONE_KEYWORD=0

if [ $# = "1" ] ;then
    ONE_KEYWORD=1
fi

for ((i = 1;i <= $#;i++)) ;do
    key="${!i}"
    [ ${ONE_KEYWORD} = 0 ] && echo "${key}:"
    if [ "$REG" = 1 ] ;then
	${command} -regex ".*/${key}"
    else
	${command} -name "${key}"
    fi
done
